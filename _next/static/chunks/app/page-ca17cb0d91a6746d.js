(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{3750:function(e,t,n){Promise.resolve().then(n.bind(n,8644)),Promise.resolve().then(n.bind(n,4880)),Promise.resolve().then(n.bind(n,4114)),Promise.resolve().then(n.bind(n,1293)),Promise.resolve().then(n.bind(n,9617))},8644:function(e,t,n){"use strict";n.d(t,{CodeBlock:function(){return c}});var a=n(7437),r=n(2265),o=n(401),s=n(8867),i=n(1747),l=n.n(i);function c(e){let{code:t,language:n="yaml"}=e,[i,c]=(0,r.useState)(!1),d=(0,r.useRef)(null);(0,r.useEffect)(()=>{d.current&&l().highlightElement(d.current)},[t,n]);let p=async()=>{await navigator.clipboard.writeText(t),c(!0),setTimeout(()=>c(!1),2e3)};return(0,a.jsxs)("div",{className:"relative group rounded-lg overflow-hidden border border-border bg-surface",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between px-4 py-2 border-b border-border bg-background/50",children:[(0,a.jsx)("span",{className:"text-xs font-mono text-text-muted uppercase",children:n}),(0,a.jsx)("button",{onClick:p,className:"flex items-center gap-1 px-2 py-1 text-xs text-text-muted hover:text-primary transition-colors","aria-label":"Copy code",children:i?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(o.Z,{className:"w-3 h-3"}),(0,a.jsx)("span",{children:"Copied!"})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(s.Z,{className:"w-3 h-3"}),(0,a.jsx)("span",{children:"Copy"})]})})]}),(0,a.jsx)("pre",{ref:d,className:"!bg-surface !m-0 overflow-x-auto max-h-[500px]",children:(0,a.jsx)("code",{className:"language-".concat(n),children:t})})]})}n(7049),n(2558)},4880:function(e,t,n){"use strict";n.d(t,{Hero:function(){return o}});var a=n(7437),r=n(4236);function o(){return(0,a.jsxs)("section",{className:"relative pt-32 pb-16 px-4 overflow-hidden",children:[(0,a.jsx)("div",{className:"absolute inset-0 bg-grid opacity-50"}),(0,a.jsxs)("div",{className:"relative max-w-4xl mx-auto text-center",children:[(0,a.jsx)(r.E.h1,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"text-5xl md:text-7xl font-bold mb-6",children:(0,a.jsx)("span",{className:"gradient-text",children:"PAQET"})}),(0,a.jsx)(r.E.p,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.1},className:"text-xl md:text-2xl text-text-muted mb-4",children:"Packet-Level Proxy with KCP Protocol"}),(0,a.jsx)(r.E.p,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.2},className:"text-text-muted max-w-2xl mx-auto",children:"Bypass the OS TCP/IP stack with raw sockets and libpcap. Optimized for gaming, VPN services, and high-performance networking."}),(0,a.jsx)(r.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.3},className:"mt-8 p-4 bg-surface rounded-lg border border-border max-w-3xl mx-auto overflow-x-auto",children:(0,a.jsx)("pre",{className:"text-sm font-mono text-primary whitespace-pre",children:"┌─────────────────────────────────────────────────────────────┐\n│  CLIENT                              SERVER                 │\n│  ───────                              ───────               │\n│                                                             │\n│  Application ──► SOCKS5/Forward ──► SMUX ──► KCP ──► pcap  │\n│                                                             │\n│              Raw TCP Packets (crafted)                      │\n│           ◄────────────────────────────────────────────►    │\n│                                                             │\n│  pcap ◄── KCP ◄── SMUX ◄── SOCKS5/Forward ◄── Application  │\n└─────────────────────────────────────────────────────────────┘"})})]})]})}},4114:function(e,t,n){"use strict";n.d(t,{Navbar:function(){return i}});var a=n(7437),r=n(2265),o=n(5135),s=n(265);function i(){let[e,t]=(0,r.useState)(!1);return(0,r.useEffect)(()=>{let e=()=>{t(window.scrollY>500)};return window.addEventListener("scroll",e),()=>window.removeEventListener("scroll",e)},[]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("nav",{className:"fixed top-0 left-0 right-0 z-40 glass border-b border-border",children:(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-4 h-16 flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-8",children:[(0,a.jsx)("a",{href:"#",className:"text-xl font-bold gradient-text",children:"PAQET"}),(0,a.jsx)("div",{className:"hidden md:flex items-center gap-6",children:(0,a.jsx)("span",{className:"text-sm text-text-muted",children:"Documentation"})})]}),(0,a.jsxs)("a",{href:"https://github.com/xQuantoM/paqet-docs",target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 px-4 py-2 text-sm text-text-muted hover:text-text transition-colors",children:[(0,a.jsx)(o.Z,{className:"w-4 h-4"}),(0,a.jsx)("span",{className:"hidden sm:inline",children:"View on GitHub"})]})]})}),e&&(0,a.jsx)("button",{onClick:()=>window.scrollTo({top:0,behavior:"smooth"}),className:"fixed bottom-8 right-8 z-50 p-3 bg-primary text-background rounded-full shadow-lg hover:bg-primary/90 transition-colors","aria-label":"Back to top",children:(0,a.jsx)(s.Z,{className:"w-5 h-5"})})]})}},1293:function(e,t,n){"use strict";n.d(t,{Sidebar:function(){return l}});var a=n(7437),r=n(2265),o=n(8372),s=n(2489),i=n(8293);function l(){let[e,t]=(0,r.useState)(""),[n,l]=(0,r.useState)(!1);(0,r.useEffect)(()=>{let e=()=>{let e=o.NS.map(e=>document.getElementById(e.id)),n=window.scrollY+100;for(let a=e.length-1;a>=0;a--){let r=e[a];if(r&&r.offsetTop<=n){t(o.NS[a].id);break}}};return window.addEventListener("scroll",e),()=>window.removeEventListener("scroll",e)},[]);let c=e=>{let t=document.getElementById(e);t&&(t.scrollIntoView({behavior:"smooth"}),l(!1))};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("button",{onClick:()=>l(!n),className:"lg:hidden fixed top-20 left-4 z-50 p-2 bg-surface border border-border rounded-lg","aria-label":"Toggle sidebar",children:n?(0,a.jsx)(s.Z,{className:"w-5 h-5"}):(0,a.jsx)(i.Z,{className:"w-5 h-5"})}),(0,a.jsx)("aside",{className:"fixed left-0 top-16 h-[calc(100vh-4rem)] w-64 bg-background border-r border-border overflow-y-auto transition-transform lg:translate-x-0 ".concat(n?"translate-x-0":"-translate-x-full"),children:(0,a.jsxs)("nav",{className:"p-4",children:[(0,a.jsx)("h2",{className:"text-sm font-semibold text-text-muted uppercase tracking-wider mb-4",children:"Documentation"}),(0,a.jsx)("ul",{className:"space-y-1",children:o.NS.map(t=>(0,a.jsx)("li",{children:(0,a.jsx)("button",{onClick:()=>c(t.id),className:"w-full text-left px-3 py-2 text-sm rounded-lg transition-colors ".concat(e===t.id?"bg-primary/10 text-primary":"text-text-muted hover:text-text hover:bg-surface"),children:t.title})},t.id))})]})})]})}},9617:function(e,t,n){"use strict";n.d(t,{ScenarioTabs:function(){return i}});var a=n(7437),r=n(2265),o=n(8644),s=n(8372);function i(){let[e,t]=(0,r.useState)("gaming"),n=Object.entries(s.pd);return(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:n.map(n=>{let[r,o]=n;return(0,a.jsx)("button",{onClick:()=>t(r),className:"px-4 py-2 text-sm font-medium rounded-lg transition-all ".concat(e===r?"bg-primary text-background":"bg-surface text-text-muted hover:text-text hover:bg-surface/80"),children:o.name},r)})}),(0,a.jsx)(o.CodeBlock,{code:s.pd[e].code||"",language:"yaml"})]})}},8372:function(e,t,n){"use strict";n.d(t,{NS:function(){return a},pd:function(){return r}});let a=[{id:"architecture-overview",title:"Architecture Overview",content:[{type:"paragraph",text:"paqet is a packet-level proxy that bypasses the OS TCP/IP stack using raw sockets and libpcap."},{type:"diagram",text:"┌─────────────────────────────────────────────────────────────────┐\n│  CLIENT                              SERVER                      │\n│  ───────                              ───────                    │\n│                                                                   │\n│  Application ──► SOCKS5/Forward ──► SMUX ──► KCP ──► pcap      │\n│                                                                   │\n│                       Raw TCP Packets (crafted)                  │\n│                    ◄────────────────────────────────────────►   │\n│                                                                   │\n│  pcap ◄── KCP ◄── SMUX ◄── SOCKS5/Forward ◄── Application      │\n└─────────────────────────────────────────────────────────────────┘"},{type:"heading",level:3,text:"Key Components"},{type:"list",items:["pcap: Captures/injects raw Ethernet frames via libpcap","Packet Crafting: Builds TCP packets with forged headers","KCP: Reliable UDP protocol with ARQ and congestion control","SMUX: Multiplexes multiple streams over one KCP connection","SOCKS5/Forward: Application-layer proxy interfaces"]}]},{id:"configuration-reference",title:"Configuration Reference",content:[{type:"heading",level:3,text:"Complete Configuration Structure"},{type:"code",language:"yaml",code:'role: "client"                    # "client" or "server"\n\nlog:\n  level: "none"                   # none, debug, info, warn, error, fatal\n\nnetwork:\n  interface: "eth0"               # Network interface name\n  guid: ""                        # Windows NPF GUID (Windows only)\n  ipv4:\n    addr: "192.168.1.100:0"       # IP:Port (port 0 = random ephemeral)\n    router_mac: "aa:bb:cc:dd:ee:ff"\n  ipv6:\n    addr: "[2001:db8::1]:0"\n    router_mac: "aa:bb:cc:dd:ee:ff"\n  pcap:\n    sockbuf: 4194304              # Ring buffer size (bytes)\n  tcp:\n    local_flag: ["PA"]            # TCP flags for outgoing packets\n    remote_flag: ["PA"]           # TCP flags for incoming packets\n\nlisten:                           # Server only\n  addr: "0.0.0.0:9999"            # Listen address\n\nserver:                           # Client only\n  addr: "10.0.0.1:9999"           # Server address\n\nsocks5:                           # Client only\n  - listen: "127.0.0.1:1080"\n    username: ""                  # Optional auth\n    password: ""\n\nforward:                          # Client only\n  - listen: "127.0.0.1:8080"\n    target: "192.168.2.1:80"\n    protocol: "tcp"               # "tcp" or "udp"\n\ntransport:\n  protocol: "kcp"\n  conn: 1                         # Parallel KCP connections (1-256)\n  tcpbuf: 8192                    # Application TCP buffer (bytes)\n  udpbuf: 4096                    # Application UDP buffer (bytes)\n  kcp:\n    mode: "fast"                  # normal, fast, fast2, fast3, manual\n    nodelay: 0                    # Manual mode only\n    interval: 30                  # Manual mode only (ms)\n    resend: 2                     # Manual mode only\n    nocongestion: 1               # Manual mode only\n    wdelay: true                  # Manual mode only\n    acknodelay: false             # Manual mode only\n    mtu: 1350                     # Max transmission unit (50-1500)\n    rcvwnd: 512                   # Receive window (1-32768)\n    sndwnd: 512                   # Send window (1-32768)\n    dshard: 0                     # FEC data shards (0 = disabled)\n    pshard: 0                     # FEC parity shards\n    block: "aes"                  # Encryption algorithm\n    key: "your-secret-key"        # Encryption key\n    smuxbuf: 4194304              # SMUX receive buffer (bytes)\n    streambuf: 2097152            # Per-stream buffer (bytes)'}]},{id:"network-layer",title:"Network Layer",content:[{type:"heading",level:3,text:"Interface Selection (network.interface)"},{type:"code",language:"yaml",code:'network:\n  interface: "eth0"        # Linux\n  # interface: "en0"       # macOS\n  # interface: "Ethernet"  # Windows (name only, GUID required)\n  guid: "\\\\Device\\\\NPF_{...}" # Windows NPF GUID'},{type:"heading",level:4,text:"Platform Notes"},{type:"list",items:["Linux: Use interface name (eth0, ens33, enp3s0)","macOS: Use interface name (en0, en1)","Windows: Must provide NPF GUID from paqet iface command"]},{type:"heading",level:4,text:"Finding Interface"},{type:"code",language:"bash",code:"# Linux/macOS\nip link show                    # or: ifconfig\n\n# Windows\npaqet iface                     # Lists interfaces with GUIDs"},{type:"heading",level:3,text:"IP Address Configuration"},{type:"code",language:"yaml",code:'ipv4:\n  addr: "192.168.1.100:0"        # IP:Port\n  router_mac: "aa:bb:cc:dd:ee:ff" # Gateway MAC'},{type:"heading",level:4,text:"Router MAC Address"},{type:"paragraph",text:"Required for packet crafting. Packets are injected directly to the gateway."},{type:"code",language:"bash",code:"# Linux\nip neigh show | grep $(ip route | grep default | awk '{print $3}')\n\n# macOS\narp -a $(netstat -rn | grep default | head -1 | awk '{print $2}')\n\n# Windows\narp -a <gateway_ip>"},{type:"heading",level:3,text:"TCP Flags (network.tcp)"},{type:"code",language:"yaml",code:'tcp:\n  local_flag: ["PA"]    # Flags for client→server packets\n  remote_flag: ["PA"]   # Flags for server→client packets'},{type:"heading",level:4,text:"Available Flags"},{type:"table",headers:["Flag","Name","Description"],rows:[["S","SYN","Connection setup"],["A","ACK","Acknowledgment"],["P","PSH","Push (deliver immediately)"],["F","FIN","Connection finish"],["R","RST","Connection reset"],["U","URG","Urgent data"],["E","ECE","ECN echo"],["C","CWR","Congestion window reduced"],["N","NS","ECN nonce"]]},{type:"heading",level:4,text:"Common Combinations"},{type:"list",items:['["PA"] - Push+Ack (standard data, default)','["A"] - Ack only (lower overhead)','["SA"] - SYN+Ack (mimic handshake response)','["PA", "A", "PA"] - Cycle through patterns (evasion)']},{type:"heading",level:3,text:"PCAP Buffer (network.pcap.sockbuf)"},{type:"code",language:"yaml",code:"pcap:\n  sockbuf: 4194304    # 4MB (client default)\n  # sockbuf: 8388608  # 8MB (server default)"},{type:"heading",level:4,text:"Sizing Guide"},{type:"table",headers:["Throughput","Recommended Size"],rows:[["<10 Mbps","4 MB"],["10-50 Mbps","8 MB"],["50-100 Mbps","16 MB"],["100+ Mbps","32-64 MB"]]}]},{id:"kcp-protocol",title:"KCP Protocol",content:[{type:"paragraph",text:"KCP is a fast and reliable ARQ protocol implemented over UDP."},{type:"heading",level:3,text:"Mode Presets (transport.kcp.mode)"},{type:"code",language:"yaml",code:'kcp:\n  mode: "fast"    # normal, fast, fast2, fast3, manual'},{type:"heading",level:4,text:"Preset Values"},{type:"table",headers:["Mode","nodelay","interval","resend","nocongestion","wdelay","acknodelay","Use Case"],rows:[["normal","0","40ms","2","1","true","false","TCP-like, conservative"],["fast","0","30ms","2","1","true","false","Balanced (default)"],["fast2","1","20ms","2","1","false","true","Low latency"],["fast3","1","10ms","2","1","false","true","Minimal latency"],["manual","custom","custom","custom","custom","custom","custom","Full control"]]},{type:"paragraph",text:'Important: When using mode presets (normal, fast, fast2, fast3), all manual mode parameters are ignored. Only use mode: "manual" when you need custom values.'},{type:"heading",level:3,text:"Manual Mode Parameters"},{type:"heading",level:4,text:"nodelay"},{type:"code",language:"yaml",code:"nodelay: 1    # 0 or 1"},{type:"list",items:["0: Conservative, TCP-like retransmission behavior","1: Aggressive, immediate retransmission on loss detection"]},{type:"heading",level:4,text:"interval"},{type:"code",language:"yaml",code:"interval: 10    # 10-5000 milliseconds"},{type:"paragraph",text:"KCP's internal update interval. Controls ACK generation and loss detection frequency. Rule of thumb: interval ≈ RTT / 2"},{type:"heading",level:4,text:"resend"},{type:"code",language:"yaml",code:"resend: 2    # 0, 1, or 2"},{type:"list",items:["0: Disable fast retransmit, wait for timeout","1: Retransmit after 1 duplicate ACK (very aggressive)","2: Retransmit after 2 duplicate ACKs (balanced)"]},{type:"heading",level:4,text:"nocongestion"},{type:"code",language:"yaml",code:"nocongestion: 1    # 0 or 1"},{type:"list",items:["0: Enable congestion control (fair sharing, slower ramp-up)","1: Disable congestion control (max throughput, may cause loss)"]},{type:"heading",level:4,text:"wdelay"},{type:"code",language:"yaml",code:"wdelay: false    # true or false"},{type:"list",items:["false: Flush immediately when data available (lower latency, more syscalls)","true: Batch writes until next interval tick (higher throughput, added latency)"]},{type:"heading",level:4,text:"acknodelay"},{type:"code",language:"yaml",code:"acknodelay: true    # true or false"},{type:"list",items:["true: Send ACK immediately on receive (faster loss detection)","false: Batch ACKs with data (bandwidth efficient)"]},{type:"heading",level:3,text:"MTU (transport.kcp.mtu)"},{type:"code",language:"yaml",code:"mtu: 1350    # 50-1500 bytes"},{type:"heading",level:4,text:"Common Values"},{type:"table",headers:["Value","Description"],rows:[["1472","Maximum safe UDP over Ethernet (1500 - 20 IP - 8 UDP)"],["1400","Safe for most internet paths"],["1350","Default, accounts for encryption overhead"],["1250","Conservative, works with VPN overhead"],["512","Maximum compatibility, gaming"]]},{type:"heading",level:3,text:"Window Sizes (rcvwnd, sndwnd)"},{type:"code",language:"yaml",code:"rcvwnd: 512    # 1-32768\nsndwnd: 512    # 1-32768"},{type:"heading",level:4,text:"Bandwidth-Delay Product"},{type:"table",headers:["Bandwidth","RTT","Min Window"],rows:[["10 Mbps","50ms","~47"],["100 Mbps","50ms","~463"],["1 Gbps","10ms","~926"]]},{type:"heading",level:3,text:"Forward Error Correction (dshard, pshard)"},{type:"code",language:"yaml",code:"dshard: 0    # Data shards (0 = disabled, default)\npshard: 0    # Parity shards"},{type:"paragraph",text:"When enabled, uses Reed-Solomon erasure coding. FEC is disabled by default."},{type:"heading",level:4,text:"When to use"},{type:"list",items:["Lossy networks (>5% packet loss)","High-latency links where retransmission is expensive","Real-time applications (gaming, VoIP)"]}]},{id:"buffers-memory",title:"Buffers & Memory",content:[{type:"heading",level:3,text:"Transport Buffers"},{type:"code",language:"yaml",code:"transport:\n  tcpbuf: 8192    # Min: 4096 bytes\n  udpbuf: 4096    # Min: 2048 bytes"},{type:"heading",level:3,text:"SMUX Buffers"},{type:"code",language:"yaml",code:"kcp:\n  smuxbuf: 4194304      # 4MB default\n  streambuf: 2097152    # 2MB default"},{type:"paragraph",text:"smuxbuf: Total buffer for all streams in a session. Minimum: 1024 bytes. streambuf: Per-stream buffer. Minimum: 1024 bytes."},{type:"heading",level:3,text:"Memory Calculation"},{type:"paragraph",text:"Per connection (approximate): Total = pcap_sockbuf + smuxbuf + (streambuf \xd7 concurrent_streams)"},{type:"code",language:"text",code:"Example server (100 connections, 10 streams each):\nPCAP: 8MB\nSMUX: 4MB \xd7 100 = 400MB\nStreams: 2MB \xd7 10 \xd7 100 = 2GB\nTotal: ~2.4GB"}]},{id:"encryption",title:"Encryption",content:[{type:"heading",level:3,text:"Algorithms (transport.kcp.block)"},{type:"code",language:"yaml",code:'kcp:\n  block: "aes"        # Encryption algorithm\n  key: "your-key"     # Any length (derived via PBKDF2)'},{type:"heading",level:4,text:"Available Algorithms"},{type:"table",headers:["Algorithm","Key Size","Speed","Notes"],rows:[["null","-","Fastest","No encryption, no authentication"],["none","-","Fastest","No encryption, has authentication"],["xor","32","Very fast","Weak, use only for testing"],["aes-128-gcm","16","Fast","Recommended - AEAD"],["aes-128","16","Fast","Hardware accelerated"],["aes / aes-256","32","Medium","Full 256-bit key"],["aes-192","24","Medium","-"],["salsa20","32","Fast","Stream cipher"],["sm4","16","Fast","Chinese standard"],["blowfish","32","Medium","Legacy"],["twofish","32","Medium","AES alternative"],["cast5","16","Medium","Legacy"],["3des","24","Slow","Avoid"],["tea","16","Fast","Weak"],["xtea","16","Fast","Improved TEA"]]},{type:"heading",level:3,text:"Key Derivation"},{type:"paragraph",text:'Keys are derived using PBKDF2 with salt "paqet" and 100,000 iterations. Recommendation: Use aes-128-gcm for best security/performance balance.'},{type:"heading",level:3,text:"Key Generation"},{type:"code",language:"bash",code:"./paqet secret"}]},{id:"connection-multiplexing",title:"Connection Multiplexing",content:[{type:"heading",level:3,text:"Multiple Connections (transport.conn)"},{type:"code",language:"yaml",code:"transport:\n  conn: 1    # 1-256 parallel KCP connections"},{type:"heading",level:4,text:"Benefits"},{type:"list",items:["Better bandwidth utilization","Reduced head-of-line blocking","Load balancing across connections"]},{type:"heading",level:4,text:"Guidelines"},{type:"table",headers:["Bandwidth","Recommended conn"],rows:[["<10 Mbps","1"],["10-50 Mbps","2-4"],["50-100 Mbps","4-8"],["100-500 Mbps","8-16"],["500+ Mbps","16-32"]]}]},{id:"os-tuning",title:"OS Tuning",content:[{type:"heading",level:3,text:"Linux Kernel Parameters"},{type:"paragraph",text:"Critical: You must set both the default and max values. Applications use the default buffer size unless they explicitly request larger buffers."},{type:"code",language:"bash",code:'# Socket buffer limits (max values)\nsysctl -w net.core.rmem_max=268435456\nsysctl -w net.core.wmem_max=268435456\n\n# Socket buffer defaults (IMPORTANT: applications use these!)\nsysctl -w net.core.rmem_default=16777216\nsysctl -w net.core.wmem_default=16777216\n\n# TCP buffer sizes: min default max\n# The middle value is the DEFAULT - must be large enough!\nsysctl -w net.ipv4.tcp_rmem="4096 8388608 268435456"\nsysctl -w net.ipv4.tcp_wmem="4096 8388608 268435456"\n\n# UDP buffers (critical for KCP)\nsysctl -w net.core.netdev_max_backlog=65536\n\n# Connection tracking (if using iptables)\nsysctl -w net.netfilter.nf_conntrack_max=1000000'},{type:"heading",level:4,text:"Make persistent across reboots"},{type:"code",language:"bash",code:"cat >> /etc/sysctl.conf << 'EOF'\nnet.core.rmem_max=268435456\nnet.core.wmem_max=268435456\nnet.core.rmem_default=16777216\nnet.core.wmem_default=16777216\nnet.ipv4.tcp_rmem=4096 8388608 268435456\nnet.ipv4.tcp_wmem=4096 8388608 268435456\nnet.core.netdev_max_backlog=65536\nEOF\n\nsysctl -p"},{type:"heading",level:3,text:"NIC Optimization"},{type:"code",language:"bash",code:"# Enable offloading\nethtool -K eth0 tso on gso on gro on\n\n# Ring buffers\nethtool -G eth0 rx 4096 tx 4096"},{type:"heading",level:3,text:"File Descriptors"},{type:"code",language:"bash",code:"ulimit -n 65535"},{type:"heading",level:3,text:"CPU Affinity"},{type:"code",language:"bash",code:"# Pin to specific cores\nsudo taskset -c 0,1 ./paqet run -c config.yaml\n\n# NUMA binding\nsudo numactl --cpunodebind=0 --membind=0 ./paqet run -c config.yaml"}]},{id:"firewall-setup",title:"Firewall Setup",content:[{type:"heading",level:3,text:"Required iptables Rules (Server)"},{type:"paragraph",text:"Critical: These rules are mandatory for proper operation."},{type:"code",language:"bash",code:"#!/bin/bash\nPORT=9999\n\n# Bypass connection tracking\niptables -t raw -A PREROUTING -p tcp --dport $PORT -j NOTRACK\niptables -t raw -A OUTPUT -p tcp --sport $PORT -j NOTRACK\n\n# Drop kernel RST packets (kernel sends RST for packets it doesn't recognize)\niptables -t mangle -A OUTPUT -p tcp --sport $PORT --tcp-flags RST RST -j DROP"},{type:"heading",level:4,text:"Why needed"},{type:"list",items:["NOTRACK: Prevents conntrack from interfering with raw packets","DROP RST: Kernel sends RST for TCP packets it didn't initiate; without this, connections die"]},{type:"heading",level:3,text:"nftables Alternative"},{type:"code",language:"bash",code:"#!/usr/sbin/nft -f\n\ntable inet paqet {\n    chain prerouting {\n        type filter hook prerouting priority raw; policy accept;\n        tcp dport 9999 notrack\n    }\n    chain output {\n        type filter hook output priority mangle; policy accept;\n        tcp sport 9999 tcp flags rst drop\n    }\n}"}]},{id:"monitoring-debugging",title:"Monitoring & Debugging",content:[{type:"heading",level:3,text:"Log Levels (log.level)"},{type:"code",language:"yaml",code:'log:\n  level: "none"    # none, debug, info, warn, error, fatal'},{type:"table",headers:["Level","Value","Use Case"],rows:[["none","-1","Production, best performance"],["debug","0","Troubleshooting, verbose"],["info","1","Normal operation"],["warn","2","Warnings only"],["error","3","Errors only"],["fatal","4","Fatal errors only"]]},{type:"paragraph",text:"Performance Impact: Debug logging can reduce throughput 10-20%. Use none in production."},{type:"heading",level:3,text:"Diagnostic Commands"},{type:"heading",level:4,text:"ping - Test Connectivity"},{type:"code",language:"bash",code:"sudo ./paqet ping -c client.yaml"},{type:"paragraph",text:"Tests: Network reachability, KCP handshake, encryption/decryption, round-trip time."},{type:"heading",level:4,text:"dump - Packet Capture"},{type:"code",language:"bash",code:"sudo ./paqet dump -p 9999           # Capture on port\nsudo ./paqet dump -i eth0 -p 9999   # Specific interface\nsudo ./paqet dump -p 9999 -v        # Verbose"},{type:"heading",level:4,text:"iface - List Interfaces"},{type:"code",language:"bash",code:"./paqet iface    # Lists interfaces with GUIDs (Windows)"},{type:"heading",level:4,text:"secret - Generate Key"},{type:"code",language:"bash",code:"./paqet secret    # Generates secure random key"}]},{id:"troubleshooting",title:"Troubleshooting",content:[{type:"heading",level:3,text:'"Message too long" Error'},{type:"paragraph",text:"Cause: KCP MTU exceeds the path MTU between client and server."},{type:"code",language:"bash",code:"# Test different sizes until one works\nping -M do -s 1472 <server_ip>   # Test 1500 byte path\nping -M do -s 1372 <server_ip>   # Test 1400 byte path"},{type:"paragraph",text:"Solution: Set KCP MTU to path_mtu - 100 (safe margin for encryption overhead). Both client and server must use the same MTU."},{type:"heading",level:3,text:"Connection Timeout / Slow Ramp-up"},{type:"paragraph",text:"Cause: nocongestion: 0 enables TCP-like congestion control, which can cause slow connection establishment on variable bandwidth links."},{type:"paragraph",text:"Solution: Use nocongestion: 1 (default) for variable bandwidth environments."},{type:"heading",level:3,text:"Config Not Applying"},{type:"paragraph",text:"Cause: Wrong YAML key names. Invalid keys are silently ignored."},{type:"table",headers:["Wrong Key","Correct Key"],rows:[["snd_wnd","sndwnd"],["rcv_wnd","rcvwnd"],["nc","nocongestion"],["data_shard","dshard"],["parity_shard","pshard"]]},{type:"heading",level:3,text:'"No buffer space available" Error'},{type:"paragraph",text:"Cause: OS socket buffer limits are too small, causing packet loss when paqet tries to write to local services."},{type:"code",language:"bash",code:"# Check current socket buffer sizes\nss -tnm | grep -A2 \":443\" | head -10\n\n# Look for rbXXXXX (receive buffer) - if it's small (e.g., rb87380 = 87KB), that's the problem\n# Should be rb8388608 (8MB) or larger"},{type:"paragraph",text:"Solution: Apply the OS tuning settings and restart paqet AND the local service to create new sockets with larger buffers."}]},{id:"scenario-configurations",title:"Scenario Configurations",content:[{type:"paragraph",text:"Pre-configured optimization profiles for common use cases. See the scenarioConfigs object below for detailed configurations."}]},{id:"quick-diagnostic-checklist",title:"Quick Diagnostic Checklist",content:[{type:"heading",level:3,text:"1. Check for Buffer Errors"},{type:"code",language:"bash",code:'journalctl -u paqet --since "1 hour ago" | grep -i "buffer"\n# If output shows "No buffer space available" → Apply OS tuning'},{type:"heading",level:3,text:"2. Verify Socket Buffer Sizes"},{type:"code",language:"bash",code:'ss -tnm | grep -A2 ":443"\n# Should show: rb8388608 or larger'},{type:"heading",level:3,text:"3. Check Retransmissions"},{type:"code",language:"bash",code:"cat /proc/net/snmp | grep Tcp\n# RetransSegs should be much smaller than OutSegs"},{type:"heading",level:3,text:"4. Verify Config Keys"},{type:"code",language:"bash",code:'grep -E "snd_wnd|rcv_wnd|data_shard|parity_shard|^nc:" /opt/paqet/config.yaml\n# If any match → fix the key names'},{type:"heading",level:3,text:"5. Check MTU"},{type:"code",language:"bash",code:'# Find path MTU\nping -M do -s 1372 <server_ip>  # Test 1400 byte path\n\n# Verify both configs use same MTU\ngrep "mtu:" /opt/paqet/config.yaml'},{type:"heading",level:3,text:"Common Issues Summary"},{type:"table",headers:["Symptom","Likely Cause","Solution"],rows:[['"No buffer space available" errors',"OS socket buffers too small","Apply OS tuning, restart services"],["60%+ overhead","Buffer overflow causing retransmissions","Apply OS tuning with 8MB default"],["Config values not applying","Wrong YAML keys","Fix key names (see Troubleshooting)"],['"Message too long" errors',"MTU too large","Reduce MTU to match path MTU"],["Slow connection ramp-up","nocongestion: 0 on variable BW","Use default or mode presets"]]}]}],r={gaming:{name:"Gaming (Low Latency)",description:"Optimized for minimal latency in real-time gaming applications.",code:'role: "client"\nlog:\n  level: "none"\n\nnetwork:\n  interface: "eth0"\n  ipv4:\n    addr: "192.168.1.100:0"\n    router_mac: "aa:bb:cc:dd:ee:ff"\n  pcap:\n    sockbuf: 4194304\n\nserver:\n  addr: "10.0.0.1:9999"\n\ntransport:\n  protocol: "kcp"\n  conn: 1\n  kcp:\n    mode: "fast3"\n    mtu: 512\n    rcvwnd: 128\n    sndwnd: 128\n    block: "aes-128-gcm"\n    key: "your-key"\n    smuxbuf: 1048576\n    streambuf: 524288'},bulk:{name:"Bulk Transfer (High Throughput)",description:"Optimized for maximum throughput in file transfers and backups.",code:'role: "client"\nlog:\n  level: "error"\n\nnetwork:\n  interface: "eth0"\n  ipv4:\n    addr: "192.168.1.100:0"\n    router_mac: "aa:bb:cc:dd:ee:ff"\n  pcap:\n    sockbuf: 16777216\n\nserver:\n  addr: "10.0.0.1:9999"\n\ntransport:\n  protocol: "kcp"\n  conn: 8\n  tcpbuf: 32768\n  kcp:\n    mode: "manual"\n    nodelay: 0\n    interval: 40\n    resend: 2\n    nocongestion: 1\n    wdelay: true\n    acknodelay: false\n    mtu: 1472\n    rcvwnd: 4096\n    sndwnd: 4096\n    block: "aes-128"\n    key: "your-key"\n    smuxbuf: 16777216\n    streambuf: 8388608'},mobile:{name:"Mobile/Lossy Network",description:"Optimized for mobile networks with high packet loss and variable latency.",code:'role: "client"\nlog:\n  level: "warn"\n\nnetwork:\n  interface: "wlan0"\n  ipv4:\n    addr: "192.168.1.100:0"\n    router_mac: "aa:bb:cc:dd:ee:ff"\n  pcap:\n    sockbuf: 8388608\n\nserver:\n  addr: "10.0.0.1:9999"\n\ntransport:\n  protocol: "kcp"\n  conn: 2\n  kcp:\n    mode: "manual"\n    nodelay: 1\n    interval: 20\n    resend: 1\n    nocongestion: 1\n    wdelay: false\n    acknodelay: true\n    mtu: 1250\n    rcvwnd: 512\n    sndwnd: 512\n    dshard: 10\n    pshard: 3\n    block: "aes-128-gcm"\n    key: "your-key"'},satellite:{name:"Satellite (High Latency)",description:"Optimized for satellite links with very high latency.",code:'role: "client"\nlog:\n  level: "error"\n\nnetwork:\n  interface: "eth0"\n  ipv4:\n    addr: "192.168.1.100:0"\n    router_mac: "aa:bb:cc:dd:ee:ff"\n  pcap:\n    sockbuf: 33554432\n\nserver:\n  addr: "10.0.0.1:9999"\n\ntransport:\n  protocol: "kcp"\n  conn: 1\n  kcp:\n    mode: "manual"\n    nodelay: 0\n    interval: 100\n    resend: 2\n    nocongestion: 1\n    wdelay: true\n    acknodelay: false\n    mtu: 1350\n    rcvwnd: 8192\n    sndwnd: 8192\n    block: "aes-128"\n    key: "your-key"\n    smuxbuf: 33554432\n    streambuf: 16777216'},datacenter:{name:"Datacenter (Maximum Performance)",description:"Optimized for datacenter environments with high bandwidth and low latency.",code:'role: "client"\nlog:\n  level: "none"\n\nnetwork:\n  interface: "eth0"\n  ipv4:\n    addr: "10.0.0.50:0"\n    router_mac: "aa:bb:cc:dd:ee:ff"\n  pcap:\n    sockbuf: 67108864\n\nserver:\n  addr: "10.0.0.1:9999"\n\ntransport:\n  protocol: "kcp"\n  conn: 16\n  tcpbuf: 65536\n  udpbuf: 16384\n  kcp:\n    mode: "manual"\n    nodelay: 1\n    interval: 10\n    resend: 2\n    nocongestion: 1\n    wdelay: false\n    acknodelay: true\n    mtu: 1472\n    rcvwnd: 8192\n    sndwnd: 8192\n    block: "null"\n    key: ""\n    smuxbuf: 67108864\n    streambuf: 33554432'},vpn:{name:"VPN Service (Traffic-Constrained)",description:"Optimized for VPN providers with traffic-limited entry servers. Prioritizes low bandwidth overhead.",clientCode:'role: "client"\nlog:\n  level: "warn"\nforward:\n  - listen: "0.0.0.0:443"\n    target: "127.0.0.1:443"\n    protocol: "tcp"\nnetwork:\n  interface: "eth0"\n  ipv4:\n    addr: "192.168.1.100:0"\n    router_mac: "aa:bb:cc:dd:ee:ff"\n  tcp:\n    local_flag: ["PA"]\n    remote_flag: ["PA"]\n  pcap:\n    sockbuf: 4194304\nserver:\n  addr: "10.0.0.1:8888"\ntransport:\n  protocol: "kcp"\n  conn: 1\n  tcpbuf: 16384\n  kcp:\n    mode: "normal"\n    key: "your-secret-key"\n    mtu: 1280\n    sndwnd: 1024\n    rcvwnd: 1024\n    block: "aes-128-gcm"\n    smuxbuf: 4194304\n    streambuf: 2097152',serverCode:'role: "server"\nlog:\n  level: "warn"\nlisten:\n  addr: ":8888"\nnetwork:\n  interface: "eth0"\n  ipv4:\n    addr: "10.0.0.1:8888"\n    router_mac: "aa:bb:cc:dd:ee:ff"\n  tcp:\n    local_flag: ["PA"]\n  pcap:\n    sockbuf: 8388608\ntransport:\n  protocol: "kcp"\n  conn: 1\n  tcpbuf: 32768\n  kcp:\n    mode: "normal"\n    key: "your-secret-key"\n    mtu: 1280\n    sndwnd: 2048\n    rcvwnd: 2048\n    block: "aes-128-gcm"\n    smuxbuf: 8388608\n    streambuf: 4194304',notes:"Key Optimizations:\n| Setting | Value | Reason |\n|---------|-------|--------|\n| mode | normal | Conservative, ~10-15% overhead |\n| conn | 1 | Single connection, minimal overhead |\n| mtu | 1280 | Safe for most path MTUs |\n| block | aes-128-gcm | Efficient authenticated encryption |\n\nExpected Performance:\n- Overhead: ~10-15% (vs 40-60% with aggressive modes)\n- Suitable for: Browsing, streaming, messaging\n- Not ideal for: Gaming, real-time voice/video"}}}},function(e){e.O(0,[938,971,117,744],function(){return e(e.s=3750)}),_N_E=e.O()}]);